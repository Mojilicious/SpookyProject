<!-- Hey, buddy, what's up? Why're you looking at the source code? There's no secret here! Honest! -->
<!DOCTYPE html>
<html>
      <!-- Now... I'm *not* going to stop you. But really, you're just in for a wild goose chase. -->
    <head>
        <meta charset="UTF-8" />    
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />    
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
        <link rel="stylesheet" href="style.css">
    </head>
    <!-- Maybe you just want to see how it works? Fine. But there's really nothing here. -->
<body>
        <!-- Will you go away if I show you a secret? -->

        <!-- Of which there are none! Now, shoo! We're all busy here!! Now, scram! -->
    <main>

    <div class="flex items-center justify-center w-full min-h-screen px-2">
        <div class="w-full max-w-[1400px]">
            <ul id="carousel" class="flex flex-row gap-0.5 h-[70vw] max-h-[650px] min-h-[250px] mb-8 md:h-[650px] md:max-h-[700px] md:min-h-[450px] lg:h-[700px] lg:max-h-[800px] lg:min-h-[500px]">
                <!-- Carousel items will be injected here -->
            </ul>
        </div>
        
    </div>
                <div id="carousel-description-box">
              <div id="carousel-description" class="fade-wrapper"></div>
            </div>
    <script src="movies.js"></script>
  <script>
      // --- Carousel Setup for Smooth Transitions ---
      const movies = window.movies;
      let activeIndex = 0;
      const carousel = document.getElementById('carousel');
      const descBox = document.getElementById('carousel-description');

      // Create carousel items only once
      function setupCarousel() {
        movies.forEach((movie, idx) => {
          const li = document.createElement('li');
          li.className = 'relative cursor-pointer overflow-hidden rounded-2xl flex-0.5 group transition-[flex] duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] h-full min-w-[80px]';
          li.style.height = '';
          li.dataset.idx = idx;
          li.innerHTML = `
            <img src="${movie.img}" alt="${movie.title}" class="object-cover w-full h-full pointer-events-none transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] grayscale" onerror="this.onerror=null;this.src='assets/jack.jpg';" />
            <div class="carousel-item-box" data-overlay="${idx}">
              <span class="carousel-title" data-idx="${idx}">
                #${idx+1}
              </span>
            </div>
          `;
          li.onclick = () => {
            if (activeIndex !== idx) {
              setActiveIndex(idx);
            }
          };
          li.onmouseover = () => {
            if (idx !== activeIndex) li.classList.add('flex-[1.5]');
            li.classList.add('hovering');
            // Animate text out, then change, then animate in
            if (idx !== activeIndex) {
              const span = li.querySelector('.carousel-title');
              if (span) {
                span.classList.remove('opacity-100','scale-100');
                span.classList.add('opacity-0','scale-95','transition-all','duration-200','ease-in');
                setTimeout(() => {
                  span.textContent = movies[idx].title;
                  span.classList.remove('opacity-0','scale-95');
                  span.classList.add('opacity-100','scale-100', 'turn-your-text-white');
                }, 120);
              }
            }
            updateCarousel();
          };
          li.onmouseout = () => {
            if (idx !== activeIndex) li.classList.remove('flex-[1.5]');
            li.classList.remove('hovering');
            // Animate text out, then change, then animate in
            if (idx !== activeIndex) {
              const span = li.querySelector('.carousel-title');
              if (span) {
                span.classList.remove('opacity-100','scale-100');
                span.classList.add('opacity-0','scale-95','transition-all','duration-200','ease-in');
                setTimeout(() => {
                  span.textContent = `#${idx+1}`;
                  span.classList.remove('opacity-0','scale-95', 'turn-your-text-white');
                  span.classList.add('opacity-100','scale-100');
                }, 120);
              }
            }
            updateCarousel();
          };
          carousel.appendChild(li);
        });
      }

      function setActiveIndex(idx) {
        activeIndex = idx;
        updateCarousel();
        updateDescription();
      }

      function updateCarousel() {
        Array.from(carousel.children).forEach((li, idx) => {
          const isActive = idx === activeIndex;
          const isHovering = li.classList.contains('hovering');
          // Make the active item much wider, hovered inactive items wider, and shrink inactive items
          let flexClass = isActive ? 'flex-[1]' : (isHovering ? 'flex-[1]' : 'flex-[0.2]');
          let minW = isActive ? 'min-w-[400px]' : (isHovering ? 'min-w-[180px]' : 'min-w-[60px]');
          let maxW = isActive ? 'max-w-[700px]' : (isHovering ? 'max-w-[250px]' : 'max-w-[120px]');
          li.className = `relative cursor-pointer overflow-hidden rounded-2xl flex-0.5 group transition-[flex,min-width,max-width] duration-[900ms] ease-in-out h-full ${minW} ${maxW} ${flexClass}`;
          li.style.height = '';
          const img = li.querySelector('img');
          if (img) {
            if (isActive) {
              img.style.filter = 'none';
            } else if (isHovering) {
              img.style.filter = 'grayscale(85%)';
            } else {
              img.style.filter = 'grayscale(100%)';
            }
            img.className = `object-cover w-full h-full pointer-events-none transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)]`;
          }
          // Update the overlay: always visible for inactive, hidden for active
          const overlayDiv = li.querySelector('[data-overlay]');
          if (overlayDiv) {
            if (isActive) {
              overlayDiv.classList.remove('opacity-0', 'scale-95');
            } else {
              overlayDiv.classList.add('opacity-100', 'scale-100');
            }
          }
          // Update the overlay span: always show number unless active (hidden). Hovered text is handled in mouse handlers only.
          const span = li.querySelector('.carousel-title');
          if (span) {
            span.className = 'pointer-events-none text-xs text-center w-full block py-1 carousel-title transition-all duration-200 ease-in';
            // Only update text if not hovered and not active
            if (!isActive && !li.classList.contains('hovering')) {
              if (span.textContent !== `#${idx+1}`) {
                span.classList.remove('opacity-100','scale-100');
                span.classList.add('opacity-0','scale-95');
                setTimeout(() => {
                  span.textContent = `#${idx+1}`;
                  span.classList.remove('opacity-0','scale-95');
                  span.classList.add('opacity-100','scale-100');
                }, 120);
              }
            }
            // If hovering and not active, mouseover handler will update the text
          }
        });
      }

      function updateDescription() {
        // Show the title as a pseudo header in the description area
        const tags = movies[activeIndex].tags.map(tag => `<span class="tag-item tag-animate">${tag}</span>`).join('');
        descBox.innerHTML = `
        <div class="movie-total">
        <span class="movie-title">${movies[activeIndex].title}</span>
        <div class="tags">${tags}</div>
        <span class="movie-desc">${movies[activeIndex].desc}</span>
        </div>
        <details class="spoiler-box">
        <summary class="spoiler-title">!!SPOILERS!! CLICK ME, if you dare!! :3</summary>
        <p class="spoiler-content">${movies[activeIndex].spoilers}</p></details>
        <div class="spoiler-tag-explain">The section above contains trigger warnings and comments about the film. <br>Please be advised of potential spoilers.</div>`;
      }

      setupCarousel();
      setActiveIndex(activeIndex);
    </script>

    </main>
</body>
</html>