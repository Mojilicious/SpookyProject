<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />    
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />    
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
        <link rel="stylesheet" href="style.css">
    </head>
<body>
    <header>
        <h1>Spookmaster's Secret List</h1>
    </header>
    <main>
    <div>Test </div>
    

    <div class="flex items-center justify-center w-full min-h-screen px-2">
        <div class="w-full max-w-[1400px]">
            <ul id="carousel" class="flex flex-row gap-0.5 h-[70vw] max-h-[650px] min-h-[250px] mb-8 md:h-[650px] md:max-h-[700px] md:min-h-[450px] lg:h-[700px] lg:max-h-[800px] lg:min-h-[500px]">
                <!-- Carousel items will be injected here -->
            </ul>
            <div id="carousel-description" class="mt-4 p-4 rounded shadow text-center text-base min-h-[60px] transition-all duration-500 md:text-lg"></div>
        </div>
    </div>
    <script src="movies.js"></script>
    <script>
      // --- Carousel Setup for Smooth Transitions ---
      const movies = window.movies;
      let activeIndex = 0;
      const carousel = document.getElementById('carousel');
      const descBox = document.getElementById('carousel-description');

      // Create carousel items only once
      function setupCarousel() {
        movies.forEach((movie, idx) => {
          const li = document.createElement('li');
          li.className = 'relative cursor-pointer overflow-hidden rounded-2xl flex-0.5 group transition-[flex] duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] h-full min-w-[80px]';
          li.style.height = '';
          li.dataset.idx = idx;
          li.innerHTML = `
            <img src="${movie.img}" alt="${movie.title}" class="object-cover w-full h-full pointer-events-none transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] grayscale" onerror="this.onerror=null;this.src='assets/jack.jpg';" />
            <div class="absolute bottom-2 left-0 w-full flex justify-center transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] bg-white bg-opacity-70 rounded ${idx === activeIndex ? 'opacity-0 scale-95' : 'group-hover:opacity-100 opacity-0 scale-100'}">
              <span class="pointer-events-none text-xs text-gray-600 text-center w-full block py-1">
                ${movie.title}
              </span>
            </div>
          `;
          li.onclick = () => {
            if (activeIndex !== idx) {
              setActiveIndex(idx);
            }
          };
          li.onmouseover = () => {
            if (idx !== activeIndex) li.classList.add('flex-[2]');
            li.classList.add('hovering');
            updateCarousel();
          };
          li.onmouseout = () => {
            if (idx !== activeIndex) li.classList.remove('flex-[2]');
            li.classList.remove('hovering');
            updateCarousel();
          };
          carousel.appendChild(li);
        });
      }

      function setActiveIndex(idx) {
        activeIndex = idx;
        updateCarousel();
        updateDescription();
      }

      function updateCarousel() {
        Array.from(carousel.children).forEach((li, idx) => {
          const isActive = idx === activeIndex;
          const isHovering = li.classList.contains('hovering');
          // Make the active item much wider, hovered inactive items wider, and shrink inactive items
          let flexClass = isActive ? 'flex-[18]' : (isHovering ? 'flex-[5]' : 'flex-[0.4]');
          let minW = isActive ? 'min-w-[400px]' : (isHovering ? 'min-w-[180px]' : 'min-w-[60px]');
          let maxW = isActive ? 'max-w-[700px]' : (isHovering ? 'max-w-[250px]' : 'max-w-[120px]');
          li.className = `relative cursor-pointer overflow-hidden rounded-2xl flex-0.5 group transition-[flex,min-width,max-width] duration-[900ms] ease-in-out h-full ${minW} ${maxW} ${flexClass}`;
          li.style.height = '';
          const img = li.querySelector('img');
          if (img) {
            if (isActive) {
              img.style.filter = 'none';
            } else if (isHovering) {
              img.style.filter = 'grayscale(85%)';
            } else {
              img.style.filter = 'grayscale(100%)';
            }
            img.className = `object-cover w-full h-full pointer-events-none transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)]`;
          }
          const titleDiv = li.querySelector('div');
          if (titleDiv) {
            titleDiv.className = `absolute bottom-2 left-0 w-full flex justify-center transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] bg-white bg-opacity-70 rounded ${isActive ? 'opacity-0 scale-95' : 'group-hover:opacity-100 opacity-0 scale-100'}`;
          }
          const span = li.querySelector('span');
          if (span) {
            span.className = 'pointer-events-none text-xs text-gray-600 text-center w-full block py-1';
            span.textContent = movies[idx].title;
          }
        });
      }

      function updateDescription() {
        // Show the title as a pseudo header in the description area
        const tags = movies[activeIndex].tags.map(tag => `<span class="inline-block bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded mr-2 mb-1">${tag}</span>`).join('');
        descBox.innerHTML = `<span class="block text-2xl font-bold mb-2 transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] opacity-0 scale-95" style="will-change:opacity,transform;">${movies[activeIndex].title}</span><div class="mt-2 mb-2">${tags}</div><span class="inline-block transition-all duration-[900ms] ease-[cubic-bezier(0.22,0.61,0.36,1)] opacity-0 scale-95 mb-2" style="will-change:opacity,transform;">${movies[activeIndex].desc}</span>`;
        setTimeout(() => {
          const spans = descBox.querySelectorAll('span');
          spans.forEach(span => {
            span.classList.remove('opacity-0','scale-95');
            span.classList.add('opacity-100','scale-100');
          });
        }, 10);
      }

      setupCarousel();
      setActiveIndex(activeIndex);
    </script>

    </main>
    <footer>
        <div class="jackenstein"></div>
        <h1 class="mt-6">Coomspook 2025 Â©</h1>
    </footer>
</body>
</html>